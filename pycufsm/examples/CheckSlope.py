import matplotlib.pyplot as plt

Xn = [0.5, 0.75, 1., 1.25, 1.5, 1.75, 2., 2.25, 2.5, 2.75,
      3., 3.25, 3.5, 3.75, 4., 4.25, 4.5, 4.75, 5., 6.,
      7., 8., 9., 10., 11., 12., 13., 14., 15., 16.,
      17., 18., 19., 20., 22., 24., 26., 28., 30., 32.,
      34., 36., 38., 40., 42., 44., 46., 48., 50., 52.,
      54., 56., 58., 60., 66., 72., 78., 84., 90., 96.,
      102., 108., 114., 120., 132., 144., 156., 168., 180., 204.,
      228., 252., 276., 300.]
"""
Yn = [7.37816001, 3.67096283, 2.3856598, 1.77143757, 1.39411889, 1.14842182,
      0.98698238, 0.87809812, 0.80269618, 0.74918354, 0.71020321, 0.68099328,
      0.6586105, 0.64140764, 0.62850082, 0.61934772, 0.61353542, 0.61071057,
      0.61056408, 0.63195612, 0.68067139, 0.75038921, 0.83759298, 0.94011687,
      1.05644319, 1.1853146, 1.32545709, 1.47529383, 1.63253023, 1.79342321,
      1.95142491, 2.09497048, 2.20588976, 2.26495649, 2.2251159, 2.07701423,
      1.90984059, 1.75604236, 1.62442988, 1.51564192, 1.42766492, 1.35782594,
      1.30350862, 1.26238577, 1.23246549, 1.21206752, 1.19977651, 1.19439088,
      1.19487428, 1.20031152, 1.20986878, 1.22275709, 1.23819762, 1.25538789,
      1.30839953, 1.34036099, 1.32172572, 1.2493031, 1.14905236, 1.04435626,
      0.94596541, 0.85726721, 0.77861689, 0.70928239, 0.59436141, 0.50449675,
      0.43332247, 0.37617553, 0.32968587, 0.25953222, 0.20997901, 0.17372727,
      0.14642425, 0.12535386]
"""
Yn = [7.37816001, 3.67096283, 2.3856598, 1.77143757, 1.39411889, 1.14842182,
      0.98698238, 0.87809812, 0.80269618, 0.74918354, 0.71020321, 0.68099328,
      0.6586105, 0.64140764, 0.62850082, 0.61934772, 0.61353542, 0.61071057,
      0.61056408, 0.63195612, 0.68067139, 0.75038921, 0.83759298, 0.94011687,
      1.05644319, 1.1853146, 1.32545709, 1.47529383, 1.63253023, 1.79342321,
      1.95142491, 2.09497048, 2.20588976, 2.26495649, 2.2251159, 2.07701423,
      1.90984059, 1.75604236, 1.62442988, 1.51564192, 1.42766492, 1.35782594,
      1.30350862, 1.26238577, 1.23246549, 1.21206752, 1.19977651, 1.19439088,
      1.19487428, 1.20031152, 1.20986878, 1.22275709, 1.23819762, 1.25538789,
      1.30839953, 1.34036099, 1.32172572, 1.2493031, 1.14905236, 1.04435626,
      0.94596541, 0.85726721, 0.77861689, 0.70928239, 0.59436141, 0.50449675,
      0.43332247, 0.37617553, 0.32968587, 0.25953222, 0.20997901, 0.17372727,
      0.14642425, 0.12535386]
YnD = [9.23028185, 4.56527901, 2.79639938, 2.00821642, 1.61346676, 1.35493303,
       1.16704909, 1.03150577, 0.93353349, 0.86285154, 0.81277884, 0.77887034,
       0.75786245, 0.74710435, 0.74442959, 0.74816722, 0.75709184, 0.77032185,
       0.78721986, 0.88366116, 1.01578289, 1.17590066, 1.35918228, 1.56133048,
       1.77752526, 2.00173212, 2.22616944, 2.44105662, 2.6351461, 2.79798486,
       2.92477705, 3.02296877, 3.11583608, 3.23445676, 3.60444735, 4.1124889,
       4.70711097, 5.36742401, 6.08476847, 6.8518068, 7.56355758, 7.16663506,
       6.63373778, 6.13286669, 5.67374499, 5.25738302, 4.88182966, 4.54400843,
       4.24053832, 3.9681238, 3.72373761, 3.50470063, 3.30871155, 3.13385379,
       2.72259487, 2.46759918, 2.363336, 2.38823556, 2.49829342, 2.65649763,
       2.84143105, 3.04109607, 3.2480289, 3.45702206, 3.8663669, 4.2471156,
       4.58681831, 4.8802743, 5.12754045, 5.49862318, 5.74040126, 5.89261083,
       5.9849632, 6.0374442]
fig, ax = plt.subplots()
ax.plot(Xn, Yn)
#ax.plot(Xn, YnD)
egim = []
for i in range(len(Xn) - 1):
    if i == 0:
        eg = (Yn[i + 1] - Yn[i]) / (Xn[i + 1] - Xn[i])
        egim.append(eg)
    eg = (Yn[i + 1] - Yn[i]) / (Xn[i + 1] - Xn[i])
    egim.append(eg)
print(egim)
ax.plot(Xn, egim)




minima = [n for n in egim if n < 0]

minima.sort()

print(minima[-1])
print(minima[-2])

print(f"Yn : {Yn[egim.index(minima[-1])]}, and {Yn[egim.index(minima[-2])]}")
print(f"Xn : {Xn[egim.index(minima[-1])]}, and {Xn[egim.index(minima[-2])]}")

plt.grid()
ax.axes.set_xscale("log")
plt.show()
